{
	"name": "ExtractLoadLatestRecords_PC_DailyLoad_SpecialTables",
	"properties": {
		"folder": {
			"name": "BISelfService"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_AzureBIHistory_Generic",
						"type": "DatasetReference"
					},
					"name": "GetActiveRecords"
				},
				{
					"dataset": {
						"referenceName": "DS_AzureBIHistory_Generic",
						"type": "DatasetReference"
					},
					"name": "GetDeletedRecords"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_AzureBISelfService_Generic_wParameters",
						"type": "DatasetReference"
					},
					"name": "InsertUpdateRecords"
				},
				{
					"dataset": {
						"referenceName": "DS_AzureBISelfService_Generic_wParameters",
						"type": "DatasetReference"
					},
					"name": "DeleteRecords"
				}
			],
			"transformations": [
				{
					"name": "AlterRow1"
				},
				{
					"name": "AlterRow2"
				},
				{
					"name": "AggregateOnPublicID"
				},
				{
					"name": "SortByADFUpdatetime"
				}
			],
			"script": "parameters{\n\tTableName as string,\n\tSchemaName as string,\n\tLoadStartDate as string\n}\nsource(output(\n\t\tReferenceDateInternal as timestamp,\n\t\tCPBlanketAutoNumberSeq as long,\n\t\tEquipmentAutoNumberSeq as long,\n\t\tWCContingencyText_Ext as string,\n\t\tEffectiveDate as timestamp,\n\t\tWCCovChangeReq_Ext as boolean,\n\t\tAutoSymbolsManualEditDate as timestamp,\n\t\tChangeType as integer,\n\t\tBusinessVehicleAutoNumberSeq as long,\n\t\tWCQuoteIssuedNO_Ext as boolean,\n\t\tWCTotalCostRPT_Ext as decimal(18,2),\n\t\tExpirationDate as timestamp,\n\t\tSplitLimits as boolean,\n\t\tCustomAutoSymbolDesc as string,\n\t\tLocationLimits as boolean,\n\t\tID as long,\n\t\tBeanVersion as integer,\n\t\tPolicyType as integer,\n\t\tManuscriptOptionDesc as string,\n\t\tBillingOption_Ext as integer,\n\t\tInitialCoveragesCreated as boolean,\n\t\tBasedOnID as long,\n\t\tViewBundledCoverages as boolean,\n\t\tWCCovChangeDate_Ext as timestamp,\n\t\tSubtype as integer,\n\t\tPollutionCleanupExp as boolean,\n\t\tWCEmployeeLeasingType_Ext as integer,\n\t\tSmallBusinessType as integer,\n\t\tGoverningClass as long,\n\t\tFixedID as long,\n\t\tWCContingency_Ext as boolean,\n\t\tRetroactiveDate as timestamp,\n\t\tWCLargeDeductInd_Ext as boolean,\n\t\tWCRedesignation_Ext as boolean,\n\t\tInitialExclusionsCreated as boolean,\n\t\tWCQuoteIssued_Ext as boolean,\n\t\tPublicID as string,\n\t\tWCNewBusWFStatus_Ext as integer,\n\t\tArchivePartition as long,\n\t\tWCElectionOwnerOfficer_Ext as integer,\n\t\tCreateUserID as long,\n\t\tClaimsMadeOrigEffDate as timestamp,\n\t\tBranchID as long,\n\t\tManuscriptPremium as decimal(18,2),\n\t\tPatternCode as string,\n\t\tWCRequestRelief_Ext as boolean,\n\t\tWCSpanishPostingNotice_Ext as boolean,\n\t\tGLCoverageForm as integer,\n\t\tUpdateUserID as long,\n\t\tWCTotalPremiumRPT_Ext as decimal(18,2),\n\t\tWCAdditionalNoticesAmount_Ext as integer,\n\t\tMailingOption_Ext as integer,\n\t\tUpdateTime as timestamp,\n\t\tWCAdditionalNotices_Ext as boolean,\n\t\tNumAddInsured as integer,\n\t\tApparatusNo_Ext as string,\n\t\tBlanketType as integer,\n\t\tWCNumOfPostingNtce_Ext as integer,\n\t\tCreateTime as timestamp,\n\t\tInitialConditionsCreated as boolean,\n\t\tPersonalVehicleAutoNumberSeq as long,\n\t\tFleet as integer,\n\t\tWCSSPRunningTtl_Ext as decimal(18,2),\n\t\tWCPreBilledAmounts_Ext as decimal(18,2),\n\t\tWCNJMTotalCostRPT_Ext as decimal(18,2),\n\t\tWCRemainingInvoices_Ext as integer,\n\t\tIsWaiveRemoved_Ext as boolean,\n\t\tPAMarketing_Ext as long,\n\t\tTenureDate_Ext as timestamp,\n\t\tInsuranceCarrier_Ext as long,\n\t\tPACSFReceived_Ext as boolean,\n\t\tGCCCOrderStatus_Ext as integer,\n\t\tTenureDateManual_Ext as boolean,\n\t\tPACSFSigLastName_MPExt as string,\n\t\tCDSPreOrdered_Ext as boolean,\n\t\tPACSFSigFirstName_MPExt as string,\n\t\tPolGroupCertificateNum_Ext as string,\n\t\tPAAnyDriverHasClaims_MPExt as boolean,\n\t\tHealthInsurerName_Ext as string,\n\t\tPolicyDriverAutoNumberSeq_Ext as long,\n\t\tPAQuotePackageIssued_Ext as boolean,\n\t\tPAInvoiceDeliveryType_Ext as integer,\n\t\tRatingWorksheet_Ext as long,\n\t\tUmbrellaPolicyNumber_Ext as string,\n\t\tCLUEOrderStatus_Ext as integer,\n\t\tFederalEmployees_Ext as boolean,\n\t\tPACSFSigMiddle_MPExt as string,\n\t\tPACSFOptions_Ext as integer,\n\t\tPARedirectPaperwork_Ext as boolean,\n\t\tMultiCarDisc_Ext as boolean,\n\t\tPACSFSuffix_MPExt as integer,\n\t\tBindTypeForDocument_Ext as boolean,\n\t\tPAFraudStatementRead_Ext as boolean,\n\t\tWCSpecialAuditOption_Ext as integer,\n\t\tDividendFailureCounter_Ext as integer,\n\t\tHasWatercraftExposure as boolean,\n\t\tDPLIPersonalLiabDeclined_Ext as boolean,\n\t\tHOInsuranceCarrier_Ext as long,\n\t\tHO455Declined_Ext as boolean,\n\t\tHO35Declined_Ext as boolean,\n\t\tHOUnderwriterConcernDate_Ext as timestamp,\n\t\tVehicleExposureAutoNumSeq as long,\n\t\tRecommendedPolicyType_Ext as integer,\n\t\tPUPInsuranceCarrier_ExtID as long,\n\t\tIsMlDollarDiscApplied_Ext as boolean,\n\t\tPUPRatingworksheet_ExtID as long,\n\t\tHOFraudStatementRead_Ext as boolean,\n\t\tBusActivityExposureAutoNumSeq as long,\n\t\tNumOfRentalPropertiesOwned_Ext as integer,\n\t\tHOQuotePackageSent_Ext as boolean,\n\t\tPUPMarketing_ExtID as long,\n\t\tPUPFraudStatementRead_Ext as boolean,\n\t\tIsLiabExtendedFromOtherPol_Ext as boolean,\n\t\tVehicleTrustEndCounter_Ext as integer,\n\t\tUnderwritingConcern_Ext as boolean,\n\t\tReasonForOverride_Ext as string,\n\t\tWatercraftExposureAutoNumSeq as long,\n\t\tSpouseName_Ext as string,\n\t\tIsNonNJMULPolicyRemoved_Ext as boolean,\n\t\tHasFraudPenalty_Ext as boolean,\n\t\tHORatingWorksheet_ExtID as long,\n\t\tHO75Declined_Ext as boolean,\n\t\tPUPUnderwritingConcern_Ext as boolean,\n\t\tHORedirectPaperwork_Ext as boolean,\n\t\tIsDLDUISuspendedLast3Yrs_Ext as boolean,\n\t\tHasPossibleRelClaims_Ext as boolean,\n\t\tIsOwnVehicle_Ext as boolean,\n\t\tHOPolicyType as integer,\n\t\tHasFraudConviction_Ext as boolean,\n\t\tIsCommercialUMBPolNeeded_Ext as boolean,\n\t\tHOBindPendPaymentSelected_Ext as boolean,\n\t\tHOMarketing_Ext as long,\n\t\tisFirstEnter_Ext as boolean,\n\t\tIsOwnerOfOTherProperties_Ext as boolean,\n\t\tIsRecPolTypeOverridden_Ext as boolean,\n\t\tIsPropertyPolicyInNJM_Ext as boolean,\n\t\tLocationTrustEndCounter_Ext as integer,\n\t\tDL2406Declined_Ext as boolean,\n\t\tLiabExtendedFromPolNumber_Ext as string,\n\t\tHOUnderwriterConcernUser_Ext as string,\n\t\tPUPUnderwriterConcernUser_Ext as string,\n\t\tHOPaidReceiptNeeded_Ext as boolean,\n\t\tActualCashValueAdvisement_Ext as boolean,\n\t\tHasLocationExposure as boolean,\n\t\tHOConversionDataID as long,\n\t\tHasBusinessActivityExposure as boolean,\n\t\tPUPQuotePackageSent_Ext as boolean,\n\t\tIsNonNJMExposureRemoved_Ext as boolean,\n\t\tIsAutoPolicyInNJM_Ext as boolean,\n\t\tHasVehicleExposure as boolean,\n\t\tExtendedCoverageStatus_Ext as integer,\n\t\tPUPBindPendPaymentSelected_Ext as boolean,\n\t\tPUPUnderwriterConcernDate_Ext as timestamp,\n\t\tPUPRedirectPaperwork_Ext as boolean,\n\t\tOverridePolicyType_Ext as integer,\n\t\tWatercraftTrustEndCounter_Ext as integer,\n\t\tHOApplyIncreaseRiskFactor_Ext as boolean,\n\t\tLiabExtendedFromPolState_Ext as integer,\n\t\tIsMockNeutralCredit as boolean,\n\t\tIsPaperlessConsentProvided_Ext as boolean,\n\t\tPAPSFReceived_Ext as boolean,\n\t\tIsPayInFullDiscountApplied_Ext as boolean,\n\t\tAccidentForgCarryoverFlag as boolean,\n\t\tPAPSFOptions_Ext as integer,\n\t\tIsPaperlessOptionChanged_Ext as boolean,\n\t\tRiskGroup_Ext as string,\n\t\tIsPaperlessDiscountApplied_Ext as boolean,\n\t\tIsHomeCurrentlyOwned_Ext as boolean,\n\t\tIsPayInFullDisAppMP_Ext as boolean,\n\t\tIsUnderlyingUMStacked_Ext as boolean,\n\t\tRiskGroupTierFCT_Ext as decimal(5,4),\n\t\tEstimatedPremiumsQB_ExtID as long,\n\t\tIsMlPropertyDiscApplied_Ext as boolean,\n\t\tIsEFTDiscountApplied_Ext as boolean,\n\t\tIsMatureDiscApplyOnPolicy_Ext as boolean,\n\t\tIsPerslAutoPolicyQB_Ext as boolean,\n\t\tIsUnderlyingUIMStacked_Ext as boolean,\n\t\tCAPReorder_Ext as boolean,\n\t\tGrandfatheredDiscount_Ext as string,\n\t\tIsUMRejectFormRcvd_Ext as boolean,\n\t\tIsUIMRejectFormRcvd_Ext as boolean,\n\t\tPAUBIOptedIn_MPExt as boolean,\n\t\tIsCSFPSFSent_Ext as boolean,\n\t\tWCExpenseConstantFullTerm_Ext as boolean,\n\t\tIsCurrOrRtrdEmpOfNJM_Ext as boolean,\n\t\tWCPreviousEmpLeasingType_Ext as integer,\n\t\tManuscriptPremium_cur as integer,\n\t\tPreferredCoverageCurrency as integer,\n\t\tCA7GarageServicesAutoNumberSeq as long,\n\t\tca7linetrailerinterchangeagree as string,\n\t\tRenewalPrem2_Ext as decimal(18,2),\n\t\tGL7QuotePackageSent_Ext as boolean,\n\t\tca7linepolicytype as string,\n\t\tGCCOrderStatus_Ext as integer,\n\t\tCA7QuotePackageSent_Ext as boolean,\n\t\tCA7NYMVLEPremium_Ext as decimal(18,2),\n\t\tca7lossratiooverall_ext as decimal(18,2),\n\t\tCA7NonModifiablePremium_Ext as decimal(18,2),\n\t\tCommercialCredit_Ext as long,\n\t\tca7linelegalentity as string,\n\t\tRenewalPrem1_Ext as decimal(18,2),\n\t\tFleetInd_Ext as boolean,\n\t\tFieldAvailabilities as string,\n\t\tPrefillOrderStatus_Ext as integer,\n\t\tca7linescheduleratingmodificat as string,\n\t\tHasAnyDriverClaims_Ext as boolean,\n\t\tAuditRequired_Ext as boolean,\n\t\tPACompFormType_Ext as integer,\n\t\tHasAnyDriverViol_Ext as boolean,\n\t\tca7linenamedinsuredindiv as string,\n\t\tca7linebasiclimcoliabpremium as decimal(10,2),\n\t\tca7lineterr as string,\n\t\tca7linegrossreceiptsratingbasi as string,\n\t\tCrossSellACD_Ext as boolean,\n\t\tCA7VehicleAutoNumberSeq as long,\n\t\tGL7StatRecord as long,\n\t\tca7linecophysdamagepremium as decimal(10,2),\n\t\tca7linefinancialresponsibility as string,\n\t\tca7lineriskanalyzerwanted as string,\n\t\tCA7ModLiabPremium_Ext as decimal(18,2),\n\t\tCA7AutoDealersAutoNumberSeq as long,\n\t\tca7lossratioclaimcount_ext as integer,\n\t\tCA7AutoSymbolsManualEditDate as timestamp,\n\t\tContingencyText_Ext as string,\n\t\tHasContingencyWording_Ext as boolean,\n\t\tca7linebasiclimcoliabpremiumov as decimal(10,2),\n\t\tCA7CompanionDiscountInd_Ext as boolean,\n\t\tca7linecophysdamagepremiumover as decimal(10,2),\n\t\tIsUWReviewComplete_Ext as boolean,\n\t\tca7lineexperiencebusinessstart as timestamp,\n\t\tPoweredVehCount_Ext as integer,\n\t\tHOCompDiscFormIndicator_Ext as boolean,\n\t\tCA7CustomAutoSymbolDesc as string,\n\t\tca7lineexperienceratingmodific as string,\n\t\tCA7PhysicalDamagePremium_Ext as decimal(18,2),\n\t\tCA7StatRecord as long,\n\t\tFirstTimeHomebuyer_Ext as boolean,\n\t\tImpactResistantGlass_Ext as boolean,\n\t\tStormShutters_Ext as boolean,\n\t\tHSBCoverageOverride_Ext as boolean,\n\t\tBP7StatRecord as long,\n\t\tPAInformedConsent_Ext as boolean,\n\t\tbp7lineterrsmsublim as string,\n\t\tbp7linetripterminatesbeforeexp as string,\n\t\tbp7linetriaexpirationdate as timestamp,\n\t\tHasCA as boolean,\n\t\tbp7lineexcludepunitivedamagesr as string,\n\t\tbp7linebusinesstype as string,\n\t\tbp7linelegalentity as string,\n\t\tSigFirstName_MPExt as string,\n\t\tHasBP7 as boolean,\n\t\tHasWC as boolean,\n\t\tbp7linetriaextended as string,\n\t\tbp7lineterr as string,\n\t\tSigLastName_MPExt as string,\n\t\tbp7linedatebusinessstarted as timestamp,\n\t\tbp7linetypeofexcl as string,\n\t\tbp7lineexcludeotheractsoutside as string,\n\t\tBlanketAutoNumberSeq as long,\n\t\tbp7lineterrcovspecificlmts as string,\n\t\tbp7lineblktrated as string,\n\t\tWCSmallDeductInd_Ext as boolean,\n\t\tbp7lineirpmapply as string,\n\t\tbp7linebusinessdesc as string,\n\t\tAnnualRevenue_Ext as decimal(18,2),\n\t\tCUPManuscriptForm_ExtSeq as long,\n\t\tBP7QuotePackageSent_Ext as boolean,\n\t\tNumberOfEmployees as integer,\n\t\tPAInformedConsentRecieved_Ext as boolean,\n\t\tIsUnderlyingUMUIMLimit_Ext as boolean,\n\t\tBP7ManuscriptForm_ExtSeq as long,\n\t\tPricingTier_Ext as integer,\n\t\tPolicyTIV_Ext as decimal(18,2),\n\t\tPolicyTierFactorCollision_Ext as decimal(6,3),\n\t\tPolicyTierFactorUIMStacked_Ext as decimal(6,3),\n\t\tPolicyTierFactorBI_Ext as decimal(6,3),\n\t\tPolicyTierFactorComp_Ext as decimal(6,3),\n\t\tPolicyTierFactorFPB_Ext as decimal(6,3),\n\t\tPolicyTierFactorUMUIM_Ext as decimal(6,3),\n\t\tCA7RenQuotePackageSent_Ext as boolean,\n\t\tPolicyTierFacUIMNonStacked_Ext as decimal(6,3),\n\t\tPolicyTierFacUMNonStacked_Ext as decimal(6,3),\n\t\tNumOfClaims_Ext as integer,\n\t\tPolicyTierFactorMed_Ext as decimal(6,3),\n\t\tPolicyTierFactorPD_Ext as decimal(6,3),\n\t\tBP7ClueReport as long,\n\t\tcupratingworksheet_extid as long,\n\t\tPriorCov_Ext as string,\n\t\tPolicyTierFactorUMStacked_Ext as decimal(6,3),\n\t\tClueRepOrderStatus_Ext as integer,\n\t\tbp7lossratiooverall_ext as decimal(18,2),\n\t\tSignatureLastName_MPExt as string,\n\t\tPredictiveOrderStatus_Ext as integer,\n\t\tbp7lossratioclaimcount_ext as integer,\n\t\tCorelationID_Ext as string,\n\t\tSignatureFirstName_MPExt as string,\n\t\tSignatureDate_MPExt as timestamp,\n\t\tSignatureSuffix_MPExt as string,\n\t\tSignatureMI_MPExt as string,\n\t\tIsMilitary_Ext as boolean,\n\t\tRescissionStatementRead_Ext as boolean,\n\t\tTerrorismRejectedPremium as decimal(10,2),\n\t\tHasVisitedProperty_Ext as boolean,\n\t\tHO38RemovalReason_Ext as integer,\n\t\tPolicyTierFactorEUIM_Ext as decimal(6,3),\n\t\tUMEIUMFormRecieved_Ext as boolean,\n\t\tNDEFormReceived_Ext as boolean,\n\t\tPIPFormReceived_Ext as boolean,\n\t\tIsMailQuoteSent_Ext as boolean,\n\t\tPolicyTierFactorPIP_Ext as decimal(6,3),\n\t\tCrimeEntityType as string,\n\t\tcp7lineeqsublimblktindicator as string,\n\t\tFullTimePartTimeEmp as integer,\n\t\tNumOfPremNotIncl as integer,\n\t\tIsAutoPayOptionSelectedMP_Ext as boolean,\n\t\tcp7linepolicytype as string,\n\t\tcp7linemublktrated as string,\n\t\tcp7linemupolicytype as string,\n\t\tcp7linemultipremiumdispcredit as string,\n\t\tCP7StatRecord as long,\n\t\tcp7linefunguswetrotdryrotbactc as string,\n\t\tCP7ManuscriptForm_ExtSeq as long,\n\t\tERISA as integer,\n\t\tCoverageForm as integer,\n\t\tcp7linetriatype as string,\n\t\tcp7linemultipremiumdispcreditf as decimal(8,4),\n\t\tAllOthersNotIncl as integer,\n\t\tNonSolicitFundsVolunteer as integer,\n\t\tcp7linerisktype as string,\n\t\tPackagePolicy as boolean,\n\t\tDirectorsOrTrustees as integer,\n\t\tLeasedAndFormerEmp as integer,\n\t\tHasGL7 as boolean,\n\t\tNonCompensatedOfficers as integer,\n\t\tCoverageType as integer,\n\t\tcp7linecondexclratingoption as string,\n\t\tcp7linetriaexpirationdate as timestamp,\n\t\tTotNumRelEmp as integer,\n\t\tNumOfPremises as integer,\n\t\tcp7lineposttriaexcl as string,\n\t\tNaturalPersons as integer,\n\t\tSolicitFundsVolunteer as integer,\n\t\tCCRClassCode as string,\n\t\tcp7lineblktrated as string,\n\t\tDeductible as integer,\n\t\tcp7linefloodcovendtblktindicat as string,\n\t\tCrimeRetroactiveDate as timestamp,\n\t\tcp7lineirpmapplies as string,\n\t\tcp7linecovforcertifiedacts as string,\n\t\tCrimePolicyType as string,\n\t\tUnderlyingExcessLimit as integer,\n\t\tcp7linetriacondexcl as string,\n\t\tOfficers as integer,\n\t\tCurrentIndicator as string,\n\t\tRowEffectiveDate as timestamp,\n\t\tRowExpirationDate as string,\n\t\tADFCreatetime as timestamp,\n\t\tADFUpdatetime as timestamp,\n\t\tDeleteIndicator as string,\n\t\tCIMAccCertActsOfTerr as integer,\n\t\tCIMTRIPTermBeforePolicyExp as integer,\n\t\tCIMCurrentTRIAExpDate as timestamp,\n\t\tUWComments as string,\n\t\tHasCPP as boolean,\n\t\tCIMTRIAExtendedPastTRIP as integer,\n\t\tNAICSCode as string,\n\t\tGL7ManuscriptForm_ExtSeq as long,\n\t\tNAICSClassification as string,\n\t\tExperienceRating as boolean,\n\t\tReportTitle as string,\n\t\tBusinessIndicationLevel as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: (\"select * from {$SchemaName}.{$TableName} where currentIndicator = 'Y' and deleteIndicator = 'N' and cast(ADFUpdateTime as date) > '{$LoadStartDate}'\"),\n\tformat: 'query',\n\tpartitionColumn: 'PublicID',\n\tpartitionBy('external', 4)) ~> GetActiveRecords\nsource(output(\n\t\tRescindNotificationDate as timestamp,\n\t\tAuditInformationID as long,\n\t\tArchiveFailureID as long,\n\t\tPurgeStatus as integer,\n\t\tRetired as long,\n\t\tRenewalCode as integer,\n\t\tCancelReasonCode as integer,\n\t\tNextPurgeCheckDate as timestamp,\n\t\tWCFEINOfficialID_Ext as boolean,\n\t\tWCAccountOrgType_Ext as boolean,\n\t\tReviewer_Ext as long,\n\t\tNonRenewalNotifDate as timestamp,\n\t\tScheduled_Ext as timestamp,\n\t\tExcludeReason as string,\n\t\tID as long,\n\t\tBeanVersion as integer,\n\t\tArchiveFailureDetailsID as long,\n\t\tChangePolicyNumber as boolean,\n\t\tWCLetterGenGroupType_Ext as integer,\n\t\tDepositDueDate_Ext as timestamp,\n\t\tPrimaryInsuredName as string,\n\t\tReinstateCode as integer,\n\t\tPaymentReceived as decimal(18,2),\n\t\tDateQuoteNeeded as timestamp,\n\t\tInternalReason_Ext as integer,\n\t\tSSN_Ext as boolean,\n\t\tBindOption as integer,\n\t\tWCTINOfficialID_Ext as boolean,\n\t\tAuditor_Ext as long,\n\t\tRewriteType as integer,\n\t\tSource as integer,\n\t\tSubtype as integer,\n\t\tManagerApprovalNeeded as boolean,\n\t\tJobGroup as long,\n\t\tPolicyID as long,\n\t\tWCPriorRenewalStatus_Ext as integer,\n\t\tCloseDate as timestamp,\n\t\tNotificationAckDate as timestamp,\n\t\tRejectReasonText as string,\n\t\tSideBySide as boolean,\n\t\tInitialNotificationDate as timestamp,\n\t\tNotificationDate as timestamp,\n\t\tRenewalNotifDate as timestamp,\n\t\tPublicID as string,\n\t\tCancelProcessDate as timestamp,\n\t\tWaived_Ext as boolean,\n\t\tArchiveSchemaInfo as long,\n\t\tArchivePartition as long,\n\t\tWCDeclineReason_Ext as integer,\n\t\tStatus_Ext as integer,\n\t\tCreateUserID as long,\n\t\tNotTakenNotifDate as timestamp,\n\t\tQuoteType as integer,\n\t\tRejectReason as integer,\n\t\tArchiveDate as timestamp,\n\t\tDocumentSent_Ext as boolean,\n\t\tPayrolls_Ext as integer,\n\t\tUpdateUserID as long,\n\t\tNoCharge_Ext as boolean,\n\t\tSubmissionDate as timestamp,\n\t\tDividentHold_Ext as boolean,\n\t\tDescription as string,\n\t\tJobNumber as string,\n\t\tEscalateAfterHoldReleased as boolean,\n\t\tEstimated_Ext as boolean,\n\t\tUpdateTime as timestamp,\n\t\tExcludedFromArchive as boolean,\n\t\tRejected as boolean,\n\t\tInsuranceCompanyCode_Ext as integer,\n\t\tNonRenewalCode as integer,\n\t\tWCBureauID_Ext as boolean,\n\t\tCreateTime as timestamp,\n\t\tPrimaryInsuredNameDenorm as string,\n\t\tSecondManager_Ext as long,\n\t\tArchiveState as integer,\n\t\tFirstManager_Ext as long,\n\t\tProducerChangeSource_Ext as integer,\n\t\tBureauIDChangedState_Ext as string,\n\t\tWCReasonCodeForCancel_Ext as integer,\n\t\tIsWCManualAudit_Ext as boolean,\n\t\tOverallStatus_Ext as integer,\n\t\tLatestAttemptStatus as integer,\n\t\tPADeclineReason_Ext as integer,\n\t\tSaveDraftClickUser_Ext as long,\n\t\tFraudAcknowledgement_MPExt as boolean,\n\t\tPARenewalQuestionnaireSent_Ext as boolean,\n\t\tDateLastSaved_Ext as timestamp,\n\t\tPAPortalStateCode_MPExt as integer,\n\t\tPolicyChangeActivity_Ext as boolean,\n\t\tCurrentSource_Ext as integer,\n\t\tFirstSaveDraftClick_Ext as timestamp,\n\t\tLastPageVisited_MPExt as string,\n\t\tOnlineSoftQuote_Ext as boolean,\n\t\tPAOtherCancelReason_Ext as integer,\n\t\tCreatedFromType_Ext as integer,\n\t\tIsPortalSubmission_MPExt as boolean,\n\t\tIsConvertedJob_Ext as boolean,\n\t\tWCAuditTransferOther_Ext as string,\n\t\tWCIndependentCompany_Ext as string,\n\t\tUserID as long,\n\t\tWCManagerApprovalTwo_Ext as boolean,\n\t\tMailDate_Ext as timestamp,\n\t\tWCPaymentPlanChangeType_Ext as integer,\n\t\tWCReissueRenewalSent_Ext as boolean,\n\t\tWCChangePaymentPlan_Ext as boolean,\n\t\tBCCancellationIndicator_Ext as boolean,\n\t\tPAReinstatementFeeFlag_Ext as boolean,\n\t\tWCNOCPackageSent_Ext as boolean,\n\t\tPANOCPackageSent_Ext as boolean,\n\t\tWCIsTrueUpReport_Ext as boolean,\n\t\tWCAuditedPremDiff_Ext as decimal(18,2),\n\t\tisReverseCancelJobDiv_Ext as boolean,\n\t\tHOOtherCancelReason_Ext as integer,\n\t\tPUPReinstatementFeeFlag_Ext as boolean,\n\t\tPUPDeclineReason_Ext as integer,\n\t\tHONOCPackageSent_Ext as boolean,\n\t\tPUPNOCPackageSent_Ext as boolean,\n\t\tHORedirectPaperwork_Ext as boolean,\n\t\tPUPRenewalQuestSent_Ext as boolean,\n\t\tDWRenewalQuestSent_Ext as boolean,\n\t\tHOReinstatementFeeFlag_Ext as boolean,\n\t\tPUPOtherCancelReason_Ext as integer,\n\t\tPUPRedirectPaperwork_Ext as boolean,\n\t\tHORenewalQuestSent_Ext as boolean,\n\t\tWCNoncomplianceCharge_Ext as boolean,\n\t\tQuoteOperationStage_Ext as integer,\n\t\tPolicyChangeUMUIMActivity_Ext as boolean,\n\t\tOriginForm_MPExt as string,\n\t\tOrigin_MPExt as string,\n\t\tLastNotifiedCancellationDate as timestamp,\n\t\tPaymentReceived_cur as integer,\n\t\tPolicyTerm as long,\n\t\tJobNumberDenorm as string,\n\t\tGL7IndependentCompany_Ext as integer,\n\t\tCARenewalQuestionnaireSent_Ext as boolean,\n\t\tCA7NOCPackageSent_Ext as boolean,\n\t\tGL7NOCPackageSent_Ext as boolean,\n\t\tCLDeclineReason_Ext as integer,\n\t\tPolicyChangeType_Ext as integer,\n\t\tCreditDebitPay_Ext as boolean,\n\t\tChangeDesc_Ext as string,\n\t\tBP7NOCPackageSent_Ext as boolean,\n\t\tCUPNOCPackageSent_Ext as boolean,\n\t\tExternalSourceApp_MPExt as string,\n\t\tCertOfNoLossRecd_Ext as boolean,\n\t\tRenewalInvoice_Ext as long,\n\t\tBCReinstateIndicator_Ext as boolean,\n\t\tCurrentIndicator as string,\n\t\tRowEffectiveDate as timestamp,\n\t\tRowExpirationDate as string,\n\t\tADFCreatetime as timestamp,\n\t\tADFUpdatetime as timestamp,\n\t\tDeleteIndicator as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: (\"select * from {$SchemaName}.{$TableName} where deleteIndicator = 'Y' and cast(ADFUpdateTime as date) > '{$LoadStartDate}'\"),\n\tformat: 'query',\n\tpartitionColumn: 'PublicID',\n\tpartitionBy('external', 4)) ~> GetDeletedRecords\nAggregateOnPublicID alterRow(upsertIf(true())) ~> AlterRow1\nGetDeletedRecords alterRow(deleteIf(true())) ~> AlterRow2\nSortByADFUpdatetime aggregate(groupBy(PublicID),\n\teach(match(name!='PublicID'), $$ = first($$))) ~> AggregateOnPublicID\nGetActiveRecords sort(desc(ADFUpdatetime, false)) ~> SortByADFUpdatetime\nAlterRow1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:false,\n\tupdateable:false,\n\tupsertable:true,\n\tkeys:['PublicID'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1,\n\terrorHandlingOption: 'stopOnFirstError') ~> InsertUpdateRecords\nAlterRow2 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:true,\n\tinsertable:false,\n\tupdateable:false,\n\tupsertable:false,\n\tkeys:['PublicID'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2,\n\terrorHandlingOption: 'stopOnFirstError') ~> DeleteRecords"
		}
	}
}